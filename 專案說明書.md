# 元心建材工程進度管理系統

## 專案概述

這是一個的工程進度管理系統，主要用於追蹤建築工程的施工進度、管理維修單、公告事項等。一個專案，可以有好幾個工程，綁定不同的案場就是不同的工程，比如說：案場(SPC)，案場(浴櫃)。
專案(PROJECT)
   工程A(案場(SPC))
      案場樓層圖
      維修單
      公告事項
   工程B(案場(浴櫃))
      案場案層圖
      維修單
      公告事項

## 目前系統架構

### 技術棧
- **前端**: Vue.js
- **後端**: Java Spring Boot
- **資料庫**: cloudflare D1 fx-crm-database
- **檔案儲存**: cloudflare R2

### 主要功能
1. **專案工程管理**
   - 新增專案 project（從商機導入，商機在cloudflare D1 fx-CRM-database裡 NewOpportunitiyObj）
   - 專案總覽頁面
   - 單一專案內可以選擇多種類型案場，不同案場=不同工程
   - 專案工程統計數據（總戶數、維修單數、工班數量、整體進度）

2. **施工進度追蹤**
   - 建立可視化的案場樓層圖=樓層×戶別 矩陣表格
   - 施工狀態標記（待施工、施工中、已完成）
   - 施工照片上傳（施工前/施工後）
   - 施工面積記錄

3. **多租戶架構**
   - 每個專案有獨立的 URL（如：/projectId/）
   - 權限管理（管理員、業主(商機連絡人)、工班負責人、工班成員）

4. **資料同步**
   - 每小時自動同步 CRM 數據
   - 案場資料儲存在cloudflare D1資料庫

## 資料庫架構

### 主要資料表 用cloudflare 的D1 資料庫 fx-crm-database
"C:\claude code\紛銷資料庫\01-紛享銷客API整合方案.md"

1. **NewOpportunityObj** - 商機資料在 fx-crm-database

2. **object_8W9cb__c** - 案場(SPC)在 FX-CRM-DATABASE

3. **object_k1XqG__c** - 維修單(SPC)在 FX-CRM-DATABASE

4. **salesrecordprogress_management_announ__c** - 進度公告管理在 FX-CRM-DATABASE

## UI/UX 設計說明

### 設計風格
- **主色調**: 藍色漸層 (#1e3c72 到 #2a5298)
- **次要色**: 綠色(成功)、黃色(警告)、紅色(錯誤)
- **字體**: -apple-system, "Microsoft JhengHei"
- **圓角**: 8-12px
- **陰影**: 輕微陰影增加層次感

### 主要元件
1. **統計卡片**: 顯示關鍵數據，帶圖標
2. **標籤導航**: 切換不同功能模組
3. **進度條**: 視覺化顯示完成度
4. **狀態標籤**: 不同顏色表示不同狀態
5. **響應式表格**: 適應不同螢幕尺寸

### 使用建議
- 所有 CSS 樣式都在 HTML 檔案中
- 可以直接複製使用
- 建議抽取成獨立的 CSS 檔案或元件庫

## UIUX範例

### 專案列表檔案

1. `/frontend/project.html` - 專案詳細頁面（包含所有 UI 元件）
2. `/frontend/project-management-dashboard.html` - 專案總覽頁面
3. `/frontend/create-project-page-ui.html` - 建立專案頁面
4. `/src/index.js` - 後端主程式
5. `/migrations/unified-schema.sql` - 資料庫架構

資料庫結構請參考：C:\claude code\工程管理\工程管理資料庫.png

細節說明：
1 建立專案："C:\claude code\工程管理\frontend\proecjt create.html"
第一步：選擇商機，第二步：選擇那種工程，一次選一種，SPC或浴櫃。第三步：顯示出有多少案場關聯商機，有多少工班，有多少維修單，有多少的進度管理公告，分開工種顯示。第四步：案場權限設置：可以(非必要)設定，工班負責人(從工地師父撈出)，工班成員(從工地師父中撈出)，業主(從商機連絡人中撈出)，設定工班是否可以看到其他工班進度

2 建立專案列表頁面："C:\claude code\工程管理\frontend\project list.html"
   1 管理員可以看到全部列表
   2 工班或業主可以看到他所擁有的專案，其權限寫在專案內部
   3 列表可以看到專案的進度，進度的計算方式來自於完成案場的數量跟未完成案場的數量的比例
   4 專案工程設定，選擇那種工程(SPC或浴櫃)，然後重覆上面的第四步，選擇案場連絡人

3 建立專案(SPC)詳情頁面："C:\claude code\工程管理\frontend\project details.html"
專案詳情頁面的專屬網址：manage.yes-ceramics.com/projectId
視覺化呈現所有的案場：
   1 棟別用分頁來呈現，A B C就是三個分頁，如果棟別是NULL，那就是當A棟
   2 樓層為縱軸(數字低在下)，戶別為橫軸，所有的戶別都要列出來，若當特定樓層及特定戶別沒有案場時，則顯示灰色
   3 點擊格子則會彈出視窗，代表進入該案場，欄位包含有 平面圖，施工前特別備註，施工前照片，舖設坪數，施工日期，施工完成，施工完照片，最後面是提交。
   4 當"施工完成"為"是"時，舖設坪數跟施工日期才會變成可編輯，舖設坪數預設為工地坪數，日期預設為今日日期
   5 案場來源為D1資料庫
   6 當"施工完成"為"是"，案場的格子轉為綠色，同時顯示日期 MM/DD，及施工人員縮寫，預設為名字最後一字
   7 專案詳情內部有個專案設定的按紐，可以新增各種人員，也可以看到人員清單
   8 案場內部有個欄位為外部顯示名稱，可以留給管理人員備註外部樓層圖需要看到的資訊


權限說明：
   1. 管理員擁有全部的權限，工班負責人可以創建工班成員，工班負責人跟成員都可以新增照片，刪除，及編輯案場，業主可以檢查
   2. USER權限記錄在專案中，同時這個權限也會分別寫到"工單"跟"商機"內(主要考量工人會跑來跑去，很有可能他做了很多場在不同的工班底下)，所以工人登入後，他應該可以在所有專案中，在登入系統，會去撈目前各專案的權限，如果發現他有在裡面的話，才會顯示出專案，如果沒有的話，就不顯示

新增成員：所有的成員都由內部成員新增而成，並不開放註冊，ID為手機號碼，密碼為手機末3碼，可以新增email做為變更密碼使用，另外有SESSION的功能，登入後下次登入不用重KEY
